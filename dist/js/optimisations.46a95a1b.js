(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["optimisations"],{"1c56":function(t,e,a){},"3bf1":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"home"},[a("div",{staticClass:"page-header"},[a("h1",{staticClass:"page-title"},[t._v("Optimisations")]),a("div",{staticClass:"actions"},[a("create-optimisation-button-and-modal")],1)]),a("optimisations-table")],1)},i=[],o=a("5530"),s=a("2f62"),r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("loading-screen",{attrs:{"is-loading":t.isDeleting}}),a("a-table",{staticClass:"axpi-table",attrs:{columns:t.columns,"row-key":function(t){return t.id},"data-source":t.data,pagination:t.pagination,loading:t.loading},on:{change:t.handleTableChange},scopedSlots:t._u([{key:"name",fn:function(e,n){return[a("router-link",{attrs:{to:t.getOptimisationLink(n)}},[t._v(" "+t._s(e)+" ")])]}},{key:"expectedCost",fn:function(e,n){return[n.min_expected_cost?a("div",[t._v(" "+t._s(t.formatCost({cost:n.min_expected_cost/100,cost_currency:"USD"}))+" "),n.max_expected_cost?a("span",[t._v(" - "+t._s(t.formatCost({cost:n.max_expected_cost/100,cost_currency:"USD"})))]):t._e()]):a("div",[t._v("-")])]}},{key:"co2e",fn:function(e,n){return[n.min_co2e?a("div",[t._v(" "+t._s(n.min_co2e)+"kg "),n.max_co2e?a("span",[t._v(" - "+t._s(n.max_co2e)+"kg")]):t._e()]):a("div",[t._v("-")])]}},{key:"created-at",fn:function(e){return[t._v(" "+t._s(t.formatDate(e))+" ")]}},{key:"actions",fn:function(e,n){return[a("a-dropdown",{attrs:{trigger:["click"]}},[a("a-button",{attrs:{type:"link",icon:"ellipsis"},on:{click:function(t){return t.preventDefault(),function(t){return t.preventDefault()}(t)}}}),a("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[a("a-menu-item",[a("router-link",{attrs:{to:t.getOptimisationLink(n)}},[t._v(" Edit ")])],1),a("a-menu-item",[a("a",{staticClass:"text-danger",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.deleteOptimisation(n)}}},[t._v("Delete")])])],1)],1)]}}])},[t._v(" A ")])],1)},c=[],l=a("bc3a"),d=a.n(l),u=a("6e12"),m=a("2d20"),p=[{title:"Name",dataIndex:"name",sorter:!0,scopedSlots:{customRender:"name"}},{title:"Scenarios",dataIndex:"optimisation_scenario_count",sorter:!0},{title:"Items",dataIndex:"optimisation_specification_count",sorter:!0},{title:"Expected Cost",dataIndex:"expectedCost",sorter:!0,scopedSlots:{customRender:"expectedCost"}},{title:"CO2e",dataIndex:"co2e",sorter:!0,scopedSlots:{customRender:"co2e"}},{title:"Date Created",dataIndex:"created_at",sorter:!0,scopedSlots:{customRender:"created-at"}},{title:"",scopedSlots:{customRender:"actions"},width:10}],f={data:function(){return{data:[],pagination:{},loading:!1,columns:p,isDeleting:!1}},mixins:[u["a"],m["a"]],mounted:function(){this.fetch()},methods:{handleTableChange:function(t,e,a){var n=Object(o["a"])({},this.pagination);n.current=t.current,this.pagination=n,this.fetch(Object(o["a"])({results_per_page:t.pageSize,page:t.current,sort_field:a.field,sort_order:a.order},e))},fetch:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};console.log("params:",e),this.loading=!0,d.a.post(window.API_BASE+"/optimisations/search",Object(o["a"])({results_per_page:10},e)).then((function(e){var a=Object(o["a"])({},t.pagination);a.total=e.data.total,t.loading=!1,t.data=e.data.data,t.pagination=a})).catch((function(e){console.log(e),t.$message.error("Error loading optimisations")}))},getOptimisationLink:function(t){return"/optimisations/"+t.id},deleteOptimisation:function(t){var e=this,a=this;a.isDeleting=!0,d.a.delete(window.API_BASE+"/optimisations/"+t.id).then((function(){a.isDeleting=!1,e.$message.success("Optimisation deleted successfully"),a.fetch()})).catch((function(t){console.log(t),a.isDeleting=!1,e.$message.error("Error deleting optimisation")}))}}},v=f,g=a("2877"),_=Object(g["a"])(v,r,c,!1,null,null,null),h=_.exports,b=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:function(e){return e.preventDefault(),t.showModal(e)}}},[t._v("Create Optimisation")]),a("a-modal",{attrs:{title:"Create Optimisation",visible:t.visible,"confirm-loading":t.isSaving,"ok-text":"Create"},on:{ok:t.attemptSave,cancel:t.handleCancel}},[a("a-form",{attrs:{layout:"vertical",form:t.form}},[a("a-form-item",{attrs:{label:"Name"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"Please enter a name"}]}],expression:"['name', {rules:[{required: true, message: 'Please enter a name'}]}]"}],attrs:{size:"large"}})],1)],1)],1)],1)},x=[],O=(a("b0c0"),a("53ca")),C=a("2ef0"),k={name:"CreateOptimisationButtonAndModal",data:function(){return{visible:!1,isSaving:!1,form:this.$form.createForm(this,{name:"create_optimisation_form"}),serverErrors:[]}},methods:{showModal:function(){this.visible=!0},attemptSave:function(){var t=this;t.isSaving=!0,this.form.validateFields((function(e,a){e?t.isSaving=!1:t.save(a)}))},save:function(t){var e=this;e.isSaving=!0,e.serverErrors=[],d.a.post(window.API_BASE+"/optimisations",{name:t.name}).then((function(t){e.$router.push("/optimisations/"+t.data.id)})).catch((function(t){var a;e.$message.error("Error creating optimisation"),e.isSaving=!1,a="object"===Object(O["a"])(t.response.data)?C.flatten(C.toArray(t.response.data.errors)):["Something went wrong. Please try again."],e.serverErrors=a}))},handleCancel:function(){this.visible=!1}}},S=k,w=(a("afc6"),Object(g["a"])(S,b,x,!1,null,"7f623aa9",null)),y=w.exports,D={name:"Optimisations",computed:Object(o["a"])({},Object(s["c"])("auth",{user:"user"})),components:{CreateOptimisationButtonAndModal:y,OptimisationsTable:h},data:function(){return{}}},E=D,j=Object(g["a"])(E,n,i,!1,null,null,null);e["default"]=j.exports},afc6:function(t,e,a){"use strict";a("1c56")}}]);
//# sourceMappingURL=optimisations.46a95a1b.js.map