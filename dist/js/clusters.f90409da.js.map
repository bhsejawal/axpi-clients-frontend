{"version":3,"sources":["webpack:///./src/views/Intelligence/Clusters/CreateClusterButtonAndModal.vue?8bc3","webpack:///./src/views/Intelligence/Clusters/Index.vue?9af7","webpack:///./src/views/Intelligence/Clusters/Index/ClustersTable.vue?2bda","webpack:///src/views/Intelligence/Clusters/Index/ClustersTable.vue","webpack:///./src/views/Intelligence/Clusters/Index/ClustersTable.vue?6646","webpack:///./src/views/Intelligence/Clusters/Index/ClustersTable.vue","webpack:///./src/views/Intelligence/Clusters/CreateClusterButtonAndModal.vue?d71c","webpack:///src/views/Intelligence/Clusters/CreateClusterButtonAndModal.vue","webpack:///./src/views/Intelligence/Clusters/CreateClusterButtonAndModal.vue?d4d9","webpack:///./src/views/Intelligence/Clusters/CreateClusterButtonAndModal.vue?9873","webpack:///src/views/Intelligence/Clusters/Index.vue","webpack:///./src/views/Intelligence/Clusters/Index.vue?f3d6","webpack:///./src/views/Intelligence/Clusters/Index.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","pageTitle","on","backToIntelligence","slot","isDeleting","insightTypeFilter","reloadKey","deleteCluster","staticRenderFns","staticClass","columns","record","id","dataToShow","pagination","loading","handleTableChange","scopedSlots","_u","key","fn","name","$event","preventDefault","handleRecordSelected","_v","_s","actions","length","potentialSavings","formatCost","cost","calculatePotentialSavings","cost_currency","e","props","mixins","Orders","data","mounted","fetch","watch","computed","_","filter","insight_type","methods","$router","push","cluster","pager","current","results_per_page","pageSize","page","sort_field","sorter","field","sort_order","order","console","log","params","total","r","$emit","each","groupedByErpOrderId","max","map","insightsForErpOrder","component","showModal","model","value","callback","$$v","visible","expression","isSaving","stage","type","indexOf","_k","keyCode","goToStageTwo","clusterName","staticStyle","canGoToStageTwo","_e","searchQuery","rowSelection","searchQueryIsDirty","productCode","canSave","save","serverErrors","selectedOrderIds","vm","determineSearchParams","q","sortField","sortOrder","onChange","getCheckboxProps","components","$route","query","incrementReloadClustersKey"],"mappings":"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","file":"js/clusters.f90409da.js","sourcesContent":["export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CreateClusterButtonAndModal.vue?vue&type=style&index=0&id=8ea4414a&scoped=true&lang=scss&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('a-page-header',{attrs:{\"title\":_vm.pageTitle},on:{\"back\":_vm.backToIntelligence}},[_c('template',{slot:\"extra\"},[_c('create-cluster-button-and-modal')],1)],2),_c('loading-screen',{attrs:{\"is-loading\":_vm.isDeleting}}),_c('clusters-table',{attrs:{\"insight-type-filter\":_vm.insightTypeFilter,\"reload-key\":_vm.reloadKey},on:{\"delete-cluster\":_vm.deleteCluster}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('a-table',{staticClass:\"axpi-table\",attrs:{\"columns\":_vm.columns,\"row-key\":function (record) { return record.id; },\"data-source\":_vm.dataToShow,\"pagination\":_vm.pagination,\"loading\":_vm.loading},on:{\"change\":_vm.handleTableChange},scopedSlots:_vm._u([{key:\"name\",fn:function(name, record){return _c('a',{attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.handleRecordSelected(record)}}},[_vm._v(_vm._s(name))])}},{key:\"numberOfItems\",fn:function(actions, record){return _c('div',{},[_vm._v(\" \"+_vm._s(record['erp_order_ids'] ? record['erp_order_ids'].length : '-')+\" \")])}},{key:\"potentialSavings\",fn:function(potentialSavings, record){return _c('div',{},[_vm._v(\" \"+_vm._s(_vm.formatCost({cost: _vm.calculatePotentialSavings(record), cost_currency: 'USD'}))+\" \")])}},{key:\"actions\",fn:function(actions, record){return _c('div',{staticClass:\"table-actions\"},[_c('a-dropdown',{attrs:{\"trigger\":['click']}},[_c('a-button',{attrs:{\"type\":\"link\",\"icon\":\"ellipsis\"},on:{\"click\":function($event){$event.preventDefault();return (function (e) { return e.preventDefault(); })($event)}}}),_c('a-menu',{attrs:{\"slot\":\"overlay\"},slot:\"overlay\"},[_c('a-menu-item',[_c('a',{staticClass:\"text-danger\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.deleteCluster(record)}}},[_vm._v(\"Delete\")])])],1)],1)],1)}}])})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <a-table class=\"axpi-table\"\n           :columns=\"columns\"\n           :row-key=\"record => record.id\"\n           :data-source=\"dataToShow\"\n           :pagination=\"pagination\"\n           :loading=\"loading\"\n           @change=\"handleTableChange\"\n  >\n    <a href=\"#\" slot=\"name\" slot-scope=\"name, record\" @click.prevent=\"handleRecordSelected(record)\">{{\n        name\n      }}</a>\n\n    <div slot=\"numberOfItems\" slot-scope=\"actions, record\">\n      {{ record['erp_order_ids'] ? record['erp_order_ids'].length : '-' }}\n    </div>\n\n    <div slot=\"potentialSavings\" slot-scope=\"potentialSavings, record\">\n      {{ formatCost({cost: calculatePotentialSavings(record), cost_currency: 'USD'}) }}\n    </div>\n\n    <div slot=\"actions\" class=\"table-actions\" slot-scope=\"actions, record\">\n      <a-dropdown :trigger=\"['click']\">\n        <a-button type=\"link\" icon=\"ellipsis\" @click.prevent=\"e => e.preventDefault()\"></a-button>\n        <a-menu slot=\"overlay\">\n          <a-menu-item>\n            <a href=\"#\" class=\"text-danger\" @click.prevent=\"deleteCluster(record)\">Delete</a>\n          </a-menu-item>\n        </a-menu>\n      </a-dropdown>\n    </div>\n  </a-table>\n</template>\n<script>\nimport axios from 'axios';\nimport Orders from \"../../../../mixins/Orders\";\n\nconst _ = require('lodash');\n\nconst columns = [\n  {\n    title: 'Name',\n    dataIndex: 'name',\n    sorter: true,\n    scopedSlots: {customRender: 'name'}\n  },\n  {\n    title: 'Number of Items',\n    scopedSlots: {customRender: 'numberOfItems'},\n  },\n  {\n    title: 'Potential Savings',\n    dataIndex: 'potential_savings',\n    scopedSlots: {customRender: 'potentialSavings'},\n  },\n  {\n    title: '',\n    scopedSlots: {customRender: 'actions'},\n    width: 10\n  }\n];\n\nexport default {\n  props: ['reloadKey', 'insightTypeFilter'],\n  mixins: [Orders],\n  data() {\n    return {\n      data: [],\n      pagination: {},\n      loading: false,\n      columns,\n    };\n  },\n  mounted() {\n    this.fetch();\n  },\n  watch: {\n    reloadKey() {\n      this.fetch();\n    }\n  },\n  computed: {\n    dataToShow() {\n      if (this.insightTypeFilter) {\n        return _.filter(this.data, d => {\n          let pricingInsights = _.filter(d['insights'], {\n            insight_type: this.insightTypeFilter\n          });\n          let potentialSavings = _.sum(_.map(pricingInsights, 'potential_savings'));\n          return potentialSavings > 0;\n        });\n      }\n      return this.data;\n    }\n  },\n  methods: {\n    handleRecordSelected(cluster) {\n      this.$router.push('/intelligence/clusters/' + cluster['_id']);\n    },\n\n    handleTableChange(pagination, filters, sorter) {\n      const pager = {...this.pagination};\n      pager.current = pagination.current;\n      this.pagination = pager;\n      this.fetch({\n        results_per_page: pagination.pageSize,\n        page: pagination.current,\n        sort_field: sorter.field,\n        sort_order: sorter.order,\n        ...filters,\n      });\n    },\n\n    fetch(params = {}) {\n      console.log('params:', params);\n      this.loading = true;\n      axios.post(window.API_BASE + '/intelligence/clusters/search', {\n        results_per_page: 100,\n        ...params\n      }).then(r => {\n        const pagination = {...this.pagination};\n        // Read total count from server\n        pagination.total = r.data.total;\n        this.loading = false;\n        this.data = r.data.data;\n        this.pagination = pagination;\n      }).catch(e => {\n        console.log(e);\n        this.$message.error('Error loading clusters');\n      });\n    },\n\n    deleteCluster(cluster) {\n      this.$emit('delete-cluster', cluster);\n    },\n\n    calculatePotentialSavings(record) {\n      console.log(record);\n      let insights = record['insights'];\n      let groupedByErpOrderId = _.groupBy(insights, 'erp_order_id');\n\n      let potentialSavings = 0;\n      _.each(groupedByErpOrderId, insightsForErpOrder => {\n        potentialSavings += _.max(_.map(insightsForErpOrder, 'potential_savings'));\n      });\n\n      return potentialSavings;\n    }\n  },\n};\n</script>\n","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ClustersTable.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ClustersTable.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ClustersTable.vue?vue&type=template&id=42f71ca0&\"\nimport script from \"./ClustersTable.vue?vue&type=script&lang=js&\"\nexport * from \"./ClustersTable.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('a-button',{attrs:{\"type\":\"primary\",\"icon\":\"plus\"},on:{\"click\":function($event){$event.preventDefault();return _vm.showModal($event)}}},[_vm._v(\" New Cluster \")]),_c('a-modal',{attrs:{\"width\":850,\"centered\":true,\"title\":\"Create Cluster\",\"footer\":null},model:{value:(_vm.visible),callback:function ($$v) {_vm.visible=$$v},expression:\"visible\"}},[_c('loading-screen',{attrs:{\"is-loading\":_vm.isSaving}}),(_vm.stage === 1)?_c('div',[_c('a-form',{attrs:{\"layout\":\"vertical\"}},[_c('a-form-item',{attrs:{\"label\":\"Name\"}},[_c('a-input',{attrs:{\"size\":\"large\"},on:{\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.goToStageTwo($event)}},model:{value:(_vm.clusterName),callback:function ($$v) {_vm.clusterName=$$v},expression:\"clusterName\"}})],1)],1),_c('div',{staticStyle:{\"text-align\":\"right\"}},[_c('a-button',{attrs:{\"disabled\":!_vm.canGoToStageTwo,\"type\":\"primary\"},on:{\"click\":_vm.goToStageTwo}},[_vm._v(\"Next \"),_c('a-icon',{attrs:{\"type\":\"arrow-right\"}})],1)],1)],1):_vm._e(),(_vm.stage === 2)?_c('div',[_c('div',{staticStyle:{\"margin-bottom\":\"20px\",\"text-align\":\"left\"}},[_c('a-input-search',{staticStyle:{\"width\":\"300px\"},attrs:{\"placeholder\":\"Search orders\"},on:{\"search\":_vm.fetch},model:{value:(_vm.searchQuery),callback:function ($$v) {_vm.searchQuery=$$v},expression:\"searchQuery\"}})],1),_c('a-table',{staticClass:\"axpi-table\",attrs:{\"columns\":_vm.columns,\"row-selection\":_vm.rowSelection,\"row-key\":function (record) { return record['_id']; },\"data-source\":_vm.data,\"pagination\":_vm.pagination,\"loading\":_vm.loading || _vm.searchQueryIsDirty},on:{\"change\":_vm.handleTableChange},scopedSlots:_vm._u([{key:\"cost\",fn:function(cost){return _c('div',{},[_vm._v(\" \"+_vm._s(_vm.formatCost({cost: cost, cost_currency: 'USD'}))+\" \")])}},{key:\"name\",fn:function(name, order){return _c('div',{},[_c('div',{staticClass:\"product-name-wrapper\"},[_c('div',{staticClass:\"left\"},[_c('a-avatar',{staticStyle:{\"margin-right\":\"20px\"},attrs:{\"size\":\"large\",\"src\":order['match_details_images']}})],1),_c('div',{staticClass:\"right\"},[_vm._v(\" \"+_vm._s(order['match_details_names'][0])+\" \")])])])}},{key:\"productCode\",fn:function(productCode, order){return _c('div',{},[_vm._v(\" \"+_vm._s(order['match_details_product_codes'][0])+\" \")])}}],null,false,2462899454)}),_c('div',{staticStyle:{\"text-align\":\"right\",\"margin-top\":\"15px\"}},[_c('a-button',{attrs:{\"disabled\":!_vm.canSave,\"type\":\"primary\"},on:{\"click\":_vm.save}},[_vm._v(\"Save \")])],1)],1):_vm._e()],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <a-button type=\"primary\" icon=\"plus\" @click.prevent=\"showModal\">\n      New Cluster\n    </a-button>\n    <a-modal\n        :width=\"850\"\n        v-model=\"visible\"\n        :centered=\"true\"\n        title=\"Create Cluster\"\n        :footer=\"null\"\n    >\n      <loading-screen :is-loading=\"isSaving\"></loading-screen>\n\n      <!-- Stage 1: Name -->\n      <div v-if=\"stage === 1\">\n        <a-form layout=\"vertical\">\n          <a-form-item label=\"Name\">\n            <a-input\n                size=\"large\"\n                v-model=\"clusterName\"\n                @keyup.enter=\"goToStageTwo\"\n            />\n          </a-form-item>\n        </a-form>\n        <div style=\"text-align: right\">\n          <a-button\n              :disabled=\"!canGoToStageTwo\"\n              type=\"primary\"\n              @click=\"goToStageTwo\"\n          >Next\n            <a-icon type=\"arrow-right\"/>\n          </a-button>\n        </div>\n      </div>\n      <!-- / Stage 1: Name -->\n\n      <!-- Stage 2: Select orders -->\n      <div v-if=\"stage === 2\">\n        <div style=\"margin-bottom: 20px; text-align: left\">\n          <a-input-search\n              placeholder=\"Search orders\"\n              v-model=\"searchQuery\"\n              style=\"width: 300px\"\n              @search=\"fetch\"\n          />\n        </div>\n\n        <a-table\n            class=\"axpi-table\"\n            :columns=\"columns\"\n            :row-selection=\"rowSelection\"\n            :row-key=\"(record) => record['_id']\"\n            :data-source=\"data\"\n            :pagination=\"pagination\"\n            :loading=\"loading || searchQueryIsDirty\"\n            @change=\"handleTableChange\"\n        >\n          <div slot=\"cost\" slot-scope=\"cost\">\n            {{ formatCost({cost: cost, cost_currency: 'USD'}) }}\n          </div>\n          <div slot=\"name\" slot-scope=\"name, order\">\n            <!-- TODO: Get most relevant product if more than one product - in which case 0 element may not be the most appropriate match -->\n            <div class=\"product-name-wrapper\">\n              <div class=\"left\">\n                <a-avatar style=\"margin-right: 20px;\"\n                          size=\"large\" :src=\"order['match_details_images']\"/>\n              </div>\n              <div class=\"right\">\n                {{ order['match_details_names'][0] }}\n              </div>\n            </div>\n          </div>\n          <div slot=\"productCode\" slot-scope=\"productCode, order\">\n            {{ order['match_details_product_codes'][0] }}\n          </div>\n        </a-table>\n\n        <div style=\"text-align: right; margin-top: 15px\">\n          <a-button :disabled=\"!canSave\" type=\"primary\" @click=\"save\"\n          >Save\n          </a-button\n          >\n        </div>\n      </div>\n      <!-- / Stage 2: Select orders -->\n    </a-modal>\n  </div>\n</template>\n\n<script>\nimport axios from \"axios\";\nimport Orders from \"../../../mixins/Orders\";\n\nconst _ = require(\"lodash\");\n\nconst columns = [\n  {\n    title: \"Name\",\n    sorter: true,\n    scopedSlots: {customRender: 'name'}\n  },\n  {\n    title: \"Cost\",\n    // dataIndex: \"Cost\",\n    dataIndex: \"CHF_FLOAT\",\n    scopedSlots: {customRender: 'cost'},\n    sorter: true,\n    width: 110\n  },\n  {\n    title: \"Product Code\",\n    // dataIndex: \"Cost\",\n    dataIndex: \"productCode\",\n    scopedSlots: {customRender: 'productCode'},\n    sorter: true,\n    width: 150\n  }\n];\n\nexport default {\n  name: \"CreateClusterButtonAndModal\",\n  mixins: [Orders],\n  data() {\n    return {\n      visible: false,\n      clusterName: \"\",\n      stage: 1,\n\n      isSaving: false,\n      serverErrors: [],\n\n      loading: false,\n      data: [],\n      pagination: {},\n      searchQuery: \"\",\n      searchQueryIsDirty: false,\n      selectedOrderIds: [],\n\n      columns,\n    };\n  },\n  watch: {\n    searchQuery: function () {\n      this.searchQueryIsDirty = true;\n      this.fetch();\n    },\n  },\n  methods: {\n    showModal() {\n      this.visible = true;\n      this.clusterName = \"\";\n      this.selectedOrderIds = [];\n      this.stage = 1;\n      this.data = [];\n      this.pagination = {};\n      this.searchQueryIsDirty = false;\n      this.selectedOrderIds = [];\n    },\n\n    goToStageTwo() {\n      if (!this.canGoToStageTwo) {\n        return false;\n      }\n      this.stage = 2;\n      this.fetch();\n    },\n\n    save() {\n      let vm = this;\n      vm.isSaving = true;\n      axios\n          .post(window.API_BASE + \"/intelligence/clusters\", {\n            name: this.clusterName,\n            erp_order_ids: this.selectedOrderIds,\n          })\n          .then((r) => {\n            vm.visible = false;\n            vm.isSaving = false;\n            vm.$router.push(\"/intelligence/clusters/\" + r.data[\"_id\"]);\n          })\n          .catch((e) => {\n            console.log(e);\n            vm.isSaving = false;\n            vm.$message.error(\"Error creating cluster\");\n          });\n    },\n\n    determineSearchParams(params) {\n      return {\n        results_per_page: 5,\n        q: this.searchQuery,\n        ...params,\n      };\n    },\n\n    fetch: _.debounce(function (params = {}) {\n      this.loading = true;\n      axios\n          .post(\n              window.API_BASE + \"/intelligence/clusters/search-erp-orders\",\n              this.determineSearchParams(params)\n          )\n          .then((r) => {\n            const pagination = {...this.pagination};\n            // Read total count from server\n            pagination.total = r.data.total;\n            this.loading = false;\n            this.data = r.data.data;\n            this.pagination = pagination;\n            this.searchQueryIsDirty = false;\n          })\n          .catch((e) => {\n            console.log(e);\n            this.$message.error(\"Error searching ERP orders\");\n          });\n    }, 500),\n\n    handleTableChange(pagination, filters, sorter) {\n      const pager = {...this.pagination};\n      pager.current = pagination.current;\n      this.pagination = pager;\n      this.fetch({\n        // results_per_page: pagination.pageSize,\n        page: pagination.current,\n        sortField: sorter.field,\n        sortOrder: sorter.order,\n        ...filters,\n      });\n    },\n  },\n  computed: {\n    canGoToStageTwo() {\n      return this.clusterName.length > 0;\n    },\n\n    canSave() {\n      return this.selectedOrderIds.length > 0;\n      // return true;\n    },\n\n    rowSelection() {\n      return {\n        onChange: (selectedRowKeys) => {\n          this.selectedOrderIds = selectedRowKeys;\n          // console.log(`selectedRowKeys: ${selectedRowKeys}`, 'selectedRows: ', selectedRows);\n        },\n        getCheckboxProps: (record) => ({\n          props: {\n            disabled: record.name === \"Disabled User\", // Column configuration not to be checked\n            name: record.name,\n          },\n        }),\n      };\n    },\n  },\n};\n</script>\n\n<style scoped lang=\"scss\">\n.product-name-wrapper {\n  display: flex;\n  flex-direction: row;\n\n  .left {\n    flex-shrink: 1;\n    display: flex;\n    align-items: center;\n  }\n\n  .right {\n    flex-grow: 1;\n    display: flex;\n    align-items: center;\n  }\n}\n</style>","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CreateClusterButtonAndModal.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CreateClusterButtonAndModal.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./CreateClusterButtonAndModal.vue?vue&type=template&id=8ea4414a&scoped=true&\"\nimport script from \"./CreateClusterButtonAndModal.vue?vue&type=script&lang=js&\"\nexport * from \"./CreateClusterButtonAndModal.vue?vue&type=script&lang=js&\"\nimport style0 from \"./CreateClusterButtonAndModal.vue?vue&type=style&index=0&id=8ea4414a&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"8ea4414a\",\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div>\n    <a-page-header :title=\"pageTitle\" @back=\"backToIntelligence\">\n      <template slot=\"extra\">\n        <create-cluster-button-and-modal></create-cluster-button-and-modal>\n      </template>\n    </a-page-header>\n\n    <loading-screen :is-loading=\"isDeleting\"></loading-screen>\n\n    <clusters-table\n        :insight-type-filter=\"insightTypeFilter\"\n        @delete-cluster=\"deleteCluster\"\n        :reload-key=\"reloadKey\"\n    ></clusters-table>\n  </div>\n</template>\n\n<script>\nimport ClustersTable from \"./Index/ClustersTable\";\nimport CreateClusterButtonAndModal from \"./CreateClusterButtonAndModal\";\nimport axios from 'axios';\n\nexport default {\n  name: \"Index\",\n  components: {CreateClusterButtonAndModal, ClustersTable},\n  data() {\n    return {\n      isDeleting: false,\n      reloadKey: 1,\n    };\n  },\n  computed: {\n    insightTypeFilter() {\n      if (this.$route.query.insight_type) {\n        return this.$route.query.insight_type;\n      }\n      return null;\n    },\n\n    pageTitle() {\n     switch (this.insightTypeFilter) {\n       case 'pricing':\n         return 'Clusters With Pricing Outlier Insights';\n       case 'demand-aggregation':\n         return 'Clusters With Demand Aggregation Insights';\n       case 'alternative-product':\n         return 'Clusters With Alternative Product Insights';\n       case 'contract-negotiation':\n         return 'Clusters With Contract Negotiation Insights';\n       case 'stockpiling-advised':\n         return 'Clusters With Stockpiling Advised Insights';\n       case 'expected-demand-increases':\n         return 'Clusters With Expected Demand Increases Insights';\n       case 'unmatched-orders':\n         return 'Clusters With Unmatched Orders Insights';\n       default:\n         return 'All Clusters';\n     }\n    }\n  },\n  watch: {\n    '$route'() {\n      this.incrementReloadClustersKey();\n    }\n  },\n  methods: {\n    backToIntelligence() {\n      this.$router.push(\"/intelligence\");\n    },\n\n    incrementReloadClustersKey() {\n      this.reloadKey += 1;\n    },\n\n    deleteCluster(cluster) {\n      let vm = this;\n      vm.isDeleting = true;\n      axios\n          .delete(window.API_BASE + \"/intelligence/clusters/\" + cluster[\"_id\"])\n          .then(() => {\n            vm.isDeleting = false;\n            vm.$message.success(\"Cluster deleted successfully\");\n            vm.incrementReloadClustersKey();\n          })\n          .catch((e) => {\n            console.log(e);\n            vm.isDeleting = false;\n            vm.$message.success(\"Error deleting order\");\n          });\n    },\n  },\n};\n</script>\n\n<style scoped>\n</style>","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Index.vue?vue&type=template&id=32804c32&scoped=true&\"\nimport script from \"./Index.vue?vue&type=script&lang=js&\"\nexport * from \"./Index.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"32804c32\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}