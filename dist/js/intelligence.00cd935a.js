(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["intelligence"],{"0351":function(t,e,s){"use strict";s("914c")},"304e":function(t,e,s){"use strict";s("3cde")},"3cde":function(t,e,s){},"4eec":function(t,e,s){"use strict";s("c460")},"654e":function(t,e,s){"use strict";s("a54f")},"7cf1":function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"filter-wrapper"},[s("div",{staticClass:"filter-header"},[s("a-checkbox",{attrs:{checked:t.isFilterEnabled},on:{change:t.toggleFilterEnabled}},[t._v(" "+t._s(t.label)+" ")])],1),t.isFilterEnabled?s("div",{staticClass:"filter"},["categorical"===t.type?s("a-select",{staticStyle:{width:"100%"},model:{value:t.details,callback:function(e){t.details=e},expression:"details"}},t._l(t.options,(function(e,a){return s("a-select-option",{key:a,attrs:{value:e.value}},[t._v(" "+t._s(e.label)+" ")])})),1):t._e()],1):t._e()])},i=[],n=(s("caad"),s("2532"),s("2ef0")),r={name:"InlineFilter",props:["filters","id","label","type","options"],data:function(){return{details:null,watchingEnabled:!1}},created:function(){var t=this;this.details=this.filters[this.id],this.$nextTick((function(){t.watchingEnabled=!0}))},computed:{isFilterEnabled:function(){return n.includes(this.filters.filters_enabled,this.id)}},methods:{toggleFilterEnabled:function(){this.filters.filters_enabled=n.xor(this.filters.filters_enabled,[this.id]),this.$emit("filter-updated")}},watch:{details:function(t){this.watchingEnabled&&(this.filters[this.id]=t,this.$emit("filter-updated"))}}},l=r,c=(s("654e"),s("2877")),o=Object(c["a"])(l,a,i,!1,null,"3a2d8a40",null);e["a"]=o.exports},8020:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"intellegence"},[s("div",{staticClass:"page-header"},[s("h1",{staticClass:"page-title"},[t._v("Axiom Insights")]),s("div",{staticClass:"actions"},[s("intelligence-filters",{attrs:{filters:t.filters},on:{"filter-updated":t.handleFilterUpdated,"set-filters":t.setFilters}}),s("a-button",{attrs:{icon:"pie-chart",type:"primary"},on:{click:function(e){return e.preventDefault(),t.viewAllClusters(e)}}},[t._v("All Clusters ")])],1)]),s("div",{staticClass:"stats"},[s("dashboard-stats",{key:t.reloadKey,attrs:{filters:t.filters}})],1),s("div",{staticClass:"insights"},[s("insights",{key:t.reloadKey,attrs:{filters:t.filters}})],1)])},i=[],n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("a-tabs",{model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},[s("a-tab-pane",{key:"all-insights",attrs:{tab:"All Insights"}}),s("a-tab-pane",{key:"price-insights",attrs:{tab:"Price Insights"}}),s("a-tab-pane",{key:"demand-insights",attrs:{tab:"Demand Insights"}})],1),t.isLoading?s("div",{staticClass:"loader"},[s("a-spin"),s("span",{staticClass:"loader-description"},[t._v("Loading all insights...")])],1):t._e(),t.isLoading?t._e():s("div",{staticClass:"insights"},[s("a-row",{attrs:{gutter:20}},t._l(t.insightsToShow,(function(e,a){return s("a-col",{key:a,attrs:{span:6}},[s("a-card",{staticClass:"insight-card",attrs:{hoverable:!0},on:{click:function(s){return s.preventDefault(),function(){return t.handleInsightClicked(e)}()}}},[s("a-statistic",{attrs:{title:e.description,prefix:"$",precision:0,value:e.amount}}),s("div",{staticClass:"insight-card-bottom"},[s("div",{staticClass:"left"},[t._v(" "+t._s(e.opportunities)+" "+t._s(1==e.opportunities?"opportunity":"opportunities")+" ")]),s("div",{staticClass:"right"},[t._v(" View "),s("a-icon",{attrs:{type:"right"}})],1)])],1)],1)})),1)],1)],1)},r=[],l=(s("4de4"),s("7db0"),s("caad"),s("d81d"),s("b64b"),s("bc3a")),c=s.n(l),o=s("2ef0"),d={props:["filters"],data:function(){return{activeTab:"all-insights",isLoading:!1,allInsights:[]}},created:function(){this.fetch()},methods:{getSearchParams:function(){var t=this,e={};return o.each(this.filters["filters_enabled"],(function(s){e[s]=t.filters[s]})),e},fetch:function(){var t=this;t.isLoading=!0,c.a.post(window.API_BASE+"/intelligence/all-insights",this.getSearchParams()).then((function(e){t.isLoading=!1,t.allInsights=e.data})).catch((function(e){console.log(e),t.isLoading=!1,t.allInsights=null,t.$message.error("Error loading all insights")}))},handleInsightClicked:function(t){this.$router.push("/intelligence/clusters?insight_type="+t["insight_type"])}},computed:{allInsightsCollapsed:function(){var t=[];return o.each(this.allInsights,(function(e){t.push(e),t=o.flatten(t)})),t},insightsToShow:function(){var t=this,e=[],s=o.groupBy(this.allInsightsCollapsed,"insight_type");o.each(s,(function(t,s){console.log(t);var a=o.groupBy(t,"erp_order_id"),i=o.groupBy(t,"cluster_id"),n=Object.keys(i).length,r=0;o.each(a,(function(t){r+=o.max(o.map(t,"potential_savings"))}));var l="Unknown";"pricing"===s&&(l="Pricing Outliers"),e.push({amount:r,opportunities:n,insight_type:s,description:l})}));var a=o.find(e,{insight_type:"pricing"});a||e.push({amount:0,opportunities:0,insight_type:"pricing",description:"Pricing Outliers"});var i=o.find(e,{insight_type:"demand-aggregration"});i||e.push({amount:0,opportunities:0,insight_type:"demand-aggregation",description:"Demand Aggregation"});var n=o.find(e,{insight_type:"alternative-product"});n||e.push({amount:0,opportunities:0,insight_type:"alternative-product",description:"Alternative Product"});var r=o.find(e,{insight_type:"contract-negotiation"});r||e.push({amount:0,opportunities:0,insight_type:"contract-negotiation",description:"Contract Negotiation"});var l=o.find(e,{insight_type:"stockpiling-advised"});l||e.push({amount:0,opportunities:0,insight_type:"stockpiling-advised",description:"Stockpiling Advised"});var c=o.find(e,{insight_type:"expected-demand-increases"});c||e.push({amount:0,opportunities:0,insight_type:"expected-demand-increases",description:"Expected Demand Increases"});var d=o.find(e,{insight_type:"unmatched-orders"});return d||e.push({amount:0,opportunities:0,insight_type:"unmatched-orders",description:"Unmatched Orders"}),o.filter(e,(function(e){return"all-insights"===t.activeTab||("price-insights"===t.activeTab?["pricing"].includes(e["insight_type"]):"demand-insights"===t.activeTab&&!["pricing"].includes(e["insight_type"]))}))}}},h=d,p=(s("0351"),s("2877")),u=Object(p["a"])(h,n,r,!1,null,"078d0cd9",null),f=u.exports,g=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t.isLoading?s("div",{staticClass:"loader stats-wrapper"},[s("a-spin"),s("span",{staticClass:"loader-description"},[t._v("Loading stats...")])],1):t._e(),!t.isLoading&&t.stats?s("div",{staticClass:"stats-wrapper"},[s("a-row",{attrs:{gutter:20}},[s("a-col",{attrs:{span:6}},[s("table",{staticClass:"axpi-basic-table"},[s("thead",[s("tr",[s("th",{attrs:{colspan:"2"}},[s("div",{staticClass:"table-header-wrapper"},[s("div",{staticClass:"table-header-left"},[s("b",[t._v("Data Overview")]),s("br"),t._v(" Current Data ")]),s("div",{staticClass:"table-header-right"},[s("a-icon",{attrs:{type:"database"}})],1)])])])]),s("tbody",[s("tr",[s("td",[t._v("Suppliers")]),s("td",[t._v(" "+t._s(t.stats["number_of_suppliers"])+" ")])]),s("tr",[s("td",[t._v("Business Units")]),s("td",[t._v(" "+t._s(t.stats["number_of_organisational_units"])+" ")])]),s("tr",[s("td",[t._v("Categories")]),s("td",[t._v(" "+t._s(t.stats["number_of_categories"])+" ")])])])])]),s("a-col",{attrs:{span:6}},[s("table",{staticClass:"axpi-basic-table"},[s("thead",[s("tr",[s("th",{attrs:{colspan:"2"}},[s("div",{staticClass:"table-header-wrapper"},[s("div",{staticClass:"table-header-left"},[s("b",[t._v("Spend")]),s("br"),t._v(" "+t._s(t.dateRange)+" ")]),s("div",{staticClass:"table-header-right"},[s("a-icon",{attrs:{type:"dollar"}})],1)])])])]),s("tbody",[s("tr",[s("td",[t._v("Spend Managed")]),s("td",[t._v(" "+t._s(t.stats["spend_managed"]?t.formatCost({cost:t.stats["spend_managed"],cost_currency:"USD"}):"-")+" ")])]),s("tr",[s("td",[t._v("Orders Classified")]),s("td",[t._v(t._s(t.stats["orders_classified_percentage"]?t.stats["orders_classified_percentage"]:"-"))])]),s("tr",[s("td",[t._v("Total Spend")]),s("td",[t._v(" "+t._s(t.stats["total_spend"]?t.formatCost({cost:t.stats["total_spend"],cost_currency:"USD"}):"-")+" ")])])])])]),s("a-col",{attrs:{span:6}},[s("table",{staticClass:"axpi-basic-table"},[s("thead",[s("tr",[s("th",{attrs:{colspan:"2"}},[s("div",{staticClass:"table-header-wrapper"},[s("div",{staticClass:"table-header-left"},[s("b",[t._v("Demand")]),s("br"),t._v(" "+t._s(t.dateRange)+" ")]),s("div",{staticClass:"table-header-right"},[s("a-icon",{attrs:{type:"up-circle"}})],1)])])])]),s("tbody",[s("tr",[s("td",[t._v("Roche Demand Change")]),s("td",[t._v(" - ")])]),s("tr",[s("td",[t._v("Market Demand Change")]),s("td",[t._v("-")])]),s("tr",[s("td",[t._v("Market Demand Volatility")]),s("td",[t._v(" - ")])])])])]),s("a-col",{attrs:{span:6}},[s("table",{staticClass:"axpi-basic-table"},[s("thead",[s("tr",[s("th",{attrs:{colspan:"2"}},[s("div",{staticClass:"table-header-wrapper"},[s("div",{staticClass:"table-header-left"},[s("b",[t._v("Risk")]),s("br"),t._v(" Current Data ")]),s("div",{staticClass:"table-header-right"},[s("a-icon",{attrs:{type:"alert"}})],1)])])])]),s("tbody",[s("tr",[s("td",[t._v("Risk Level")]),s("td",[t._v(" - ")])]),s("tr",[s("td",[t._v("Suppliers at Risk")]),s("td",[t._v("-")])])])])])],1)],1):t._e()])},v=[],_=(s("2532"),s("5530")),b=s("2d20"),m=s("2f62"),C=s("2ef0"),y={name:"DashboardStats",props:["filters"],mixins:[b["a"]],data:function(){return{isLoading:!1,stats:[]}},computed:Object(_["a"])(Object(_["a"])({},Object(m["c"])("auth",{user:"user"})),{},{dateRange:function(){if(this.filters["filters_enabled"].length&&this.filters["filters_enabled"].includes("date_range")){if("last-5-years"==this.filters["date_range"])return"Last 5 Years";if("last-12-months"==this.filters["date_range"])return"Last 12 Months";if("last-month"==this.filters["date_range"])return"Last Month"}return"Last 12 Months"}}),created:function(){this.fetch()},methods:{fetch:function(){var t=this;t.isLoading=!0,c.a.post(window.API_BASE+"/intelligence/stats",this.getSearchParams()).then((function(e){t.isLoading=!1,t.stats=e.data})).catch((function(e){console.log(e),t.isLoading=!1,t.stats=null,t.$message.error("Error loading stats")}))},getSearchParams:function(){var t=this,e={};return C.each(this.filters["filters_enabled"],(function(s){e[s]=t.filters[s]})),Object.keys(e).includes("date_range")||(e["date_range"]="last-12-months"),e}}},k=y,w=(s("304e"),Object(p["a"])(k,g,v,!1,null,"f33e5174",null)),L=w.exports,E=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("a-popover",{attrs:{placement:"bottomRight",trigger:"click"}},[s("template",{slot:"title"},[s("div",{staticClass:"filter-title-wrapper"},[s("div",{staticClass:"left"},[s("a-button",{attrs:{size:"small"},on:{click:function(e){return e.preventDefault(),t.clear(e)}}},[t._v("Clear")])],1),s("div",{staticClass:"center"},[t._v(" Filters ")]),s("div",{staticClass:"right"},[s("a-button",{attrs:{disabled:!t.hasUnsavedChanges,type:"primary",size:"small"},on:{click:t.save}},[t._v("Save ")])],1)])]),s("template",{slot:"content"},[s("div",{staticClass:"filters-inner"},[s("inline-filter",{attrs:{filters:t.filtersLocal,id:"date_range",label:"Date range",type:"categorical",options:t.dateRangeOptions},on:{"filter-updated":t.handleFilterUpdated}})],1)]),s("a-button",{attrs:{icon:"filter"}},[t._v("Filter")])],2)},x=[],F=s("7cf1"),D=s("2ef0"),I={name:"IntelligenceFilters",props:["filters"],components:{InlineFilter:F["a"]},data:function(){return{filtersLocal:null,hasUnsavedChangesFromEvent:!1,dateRangeOptions:[{value:"last-5-years",label:"Last 5 years"},{value:"last-12-months",label:"Last 12 months"},{value:"last-month",label:"Last month"}]}},created:function(){this.filtersLocal=D.cloneDeep(this.filters)},computed:{hasUnsavedChanges:function(){var t=!1,e=D.difference(this.filters.filters_enabled,this.filtersLocal.filters_enabled),s=D.difference(this.filtersLocal.filters_enabled,this.filters.filters_enabled);return D.merge(e,s).length&&(t=!0),t||this.hasUnsavedChangesFromEvent}},methods:{handleFilterUpdated:function(){this.hasUnsavedChangesFromEvent=!0},clear:function(){this.filtersLocal.filters_enabled=[]},save:function(){this.$emit("set-filters",D.cloneDeep(this.filtersLocal)),this.$emit("filter-updated"),this.hasUnsavedChangesFromEvent=!1}}},S=I,O=Object(p["a"])(S,E,x,!1,null,"07ffb68b",null),U=O.exports,$={components:{IntelligenceFilters:U,DashboardStats:L,Insights:f},methods:{viewAllClusters:function(){this.$router.push("/intelligence/clusters")},incrementReloadKey:function(){this.reloadKey+=1},setFilters:function(t){this.filters=t},handleFilterUpdated:function(){this.incrementReloadKey()}},data:function(){return{reloadKey:1,filters:{filters_enabled:{},date_range:"last-12-months"}}}},A=$,R=(s("4eec"),Object(p["a"])(A,a,i,!1,null,"7133ef9c",null));e["default"]=R.exports},"914c":function(t,e,s){},a54f:function(t,e,s){},c460:function(t,e,s){}}]);
//# sourceMappingURL=intelligence.00cd935a.js.map