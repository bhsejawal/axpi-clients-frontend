(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["basket"],{1045:function(t,e,r){},2635:function(t,e,r){},"2d8f":function(t,e,r){},"2fb3":function(t,e,r){"use strict";r.r(e);var i=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"shop-basket"},[r("a-layout",[r("a-layout",{staticStyle:{padding:"7px 30px"}},[r("div",{staticClass:"wrapper"},[r("a-page-header",{attrs:{title:"Basket"},on:{back:t.goBackToShop}},[r("template",{slot:"extra"},[r("a-button",{attrs:{icon:"shopping-cart",type:"primary"}},[t._v("Checkout")])],1)],2)],1),!t.order||"order"!==t.type&&"specification"!==t.type?t._e():r("edit-order-modal",{attrs:{suppliers:t.suppliers}}),r("div",{key:t.tableUpdateKey,staticClass:"table-wrapper"},[t.isLoading?t._e():r("a-table",{staticClass:"axpi-table",attrs:{columns:t.columns,pagination:!1,"data-source":t.basket,loading:t.isLoading},scopedSlots:t._u([{key:"name",fn:function(e,i){return r("div",{},["product"==i.itemType?r("router-link",{attrs:{to:t.getProductPageUrl(i)}},[t._v(t._s(e)+" ")]):t._e(),"order"==i.itemType?r("a",{attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.editOrder(i.order)}}},[t._v(t._s(e)+" ")]):t._e(),"specification"==i.itemType?r("a",{attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.editSpecification(i.specification)}}},[t._v(t._s(e)+" ")]):t._e()],1)}},{key:"image",fn:function(e,i){return r("div",{},[r("a-avatar",{attrs:{size:"large",src:t.getImageSrc(i)}})],1)}},{key:"quantity",fn:function(e,i){return r("div",{},["product"===i.itemType?r("div",{staticClass:"quantity-changer"},[r("a-input-group",{attrs:{compact:""}},[r("a-button",{attrs:{icon:"minus"},on:{click:function(e){return e.preventDefault(),function(){return t.decrementProductQuantity({product:i.product,selectedPriceId:i.selectedPriceId})}()}}}),r("a-input",{staticClass:"quantity-input",attrs:{type:"number",value:i.quantity},on:{change:function(e){return t.setProductQuantity({quantity:e.target.value,id:i["id"],selectedPriceId:i.selectedPriceId})}}}),r("a-button",{attrs:{icon:"plus"},on:{click:function(e){return e.preventDefault(),function(){return t.incrementProductQuantity({product:i.product,selectedPriceId:i.selectedPriceId})}()}}})],1)],1):t._e(),"order"===i.itemType?r("div",{staticClass:"quantity-changer"},[r("a-input-group",{attrs:{compact:""}},[r("a-button",{attrs:{icon:"minus"},on:{click:function(e){return e.preventDefault(),function(){return t.decrementPastOrderQuantity(i.order)}()}}}),r("a-input",{staticClass:"quantity-input",attrs:{type:"number",value:i.quantity},on:{change:function(e){return t.setPastOrderQuantity({quantity:e.target.value,id:i["id"]})}}}),r("a-button",{attrs:{icon:"plus"},on:{click:function(e){return e.preventDefault(),function(){return t.incrementPastOrderQuantity(i.order)}()}}})],1)],1):t._e(),"specification"===i.itemType?r("div",{staticClass:"quantity-changer"},[r("a-input-group",{attrs:{compact:""}},[r("a-button",{attrs:{icon:"minus"},on:{click:function(e){return e.preventDefault(),function(){return t.decrementSpecificationQuantity(i.specification)}()}}}),r("a-input",{staticClass:"quantity-input",attrs:{type:"number",value:i.quantity},on:{change:function(e){return t.setSpecificationQuantity({quantity:e.target.value,id:i["id"]})}}}),r("a-button",{attrs:{icon:"plus"},on:{click:function(e){return e.preventDefault(),function(){return t.incrementSpecificationQuantity(i.specification)}()}}})],1)],1):t._e()])}},{key:"supplier",fn:function(e,i){return r("div",{},[!i.isLoadingPrices&&i.prices&&i.selectedPrice?r("a-select",{staticStyle:{width:"200px"},attrs:{value:i.selectedPrice.id,"option-filter-prop":"children","filter-option":t.filterOption,"show-search":""},on:{change:function(e){return t.selectPriceById(i,e)}}},t._l(i.prices,(function(e,i){return r("a-select-option",{key:i,attrs:{value:e.id}},[t._v(" "+t._s(e.supplier_name)+" ")])})),1):r("span",[i.isLoadingPrices?r("a-spin",{attrs:{size:"small"}}):r("span",[t._v("No suppliers")])],1)],1)}},{key:"cost",fn:function(e,i){return r("div",{},[i.isLoadingPrices?r("a-spin",{attrs:{size:"small"}}):t._e(),i.isLoadingPrices?t._e():r("div",["Suggested"===t.getSavingType(i)?r("div",[r("span",[t._v(" "+t._s(i.selectedPrice?t.formatCostInPence2dp({cost:t.getPriceToShow(i.selectedPrice.price,i.quantity,i.itemType),cost_currency:"USD"}):"-")+" ")])]):t._e(),"Exact"===t.getSavingType(i)?r("div",[r("span",[t._v(" "+t._s(i.selectedPrice?t.formatCostInPence2dp({cost:i.order.cost,cost_currency:"USD"}):"-")+" ")])]):t._e(),i.prices&&i.selectedPrice?r("div",{staticStyle:{"margin-top":"10px"}},[r("span",[t._v(t._s(t.getSavings(i)?t.formatCostInPence2dp({cost:t.getSavings(i),cost_currency:"USD"}):"-"))])]):t._e()])],1)}},{key:"cost-tags",fn:function(e,i){return r("div",{},[i.isLoadingPrices?r("a-spin",{attrs:{size:"small"}}):t._e(),i.isLoadingPrices?t._e():r("div",["Suggested"===t.getSavingType(i)?r("div",[i.prices&&i.selectedPrice?r("a-tag",{staticStyle:{"margin-left":"5px"},attrs:{color:"blue"}},[t._v("Suggested ")]):t._e()],1):t._e(),"Exact"===t.getSavingType(i)?r("div",[r("a-tag",{staticStyle:{"margin-left":"5px"},attrs:{color:"blue"}},[t._v("Exact ")])],1):t._e(),i.prices&&i.selectedPrice?r("div",{staticStyle:{"margin-top":"10px"}},[r("a-tag",{staticStyle:{"margin-left":"5px"},attrs:{color:t.getSavings(i)&&t.getSavings(i)>0?"green":"red"}},[t._v("Savings ")])],1):t._e()])],1)}},{key:"co2e",fn:function(e,i){return r("div",{},[i.isLoadingPrices?r("a-spin",{attrs:{size:"small"}}):r("span",[t.getTotalCo2e(i)?r("span",[t._v(t._s(t.getTotalCo2e(i))+" kg")]):r("a-tag",{attrs:{color:"red"}},[t._v("Unknown")])],1)],1)}},{key:"actions",fn:function(e,i){return r("div",{},[r("div",{staticClass:"actions"},["product"!==i.itemType?r("request-quote-button"):t._e()],1)])}},{key:"expandedRowRender",fn:function(t){return r("div",{},[r("basket-row-inner",{attrs:{row:t}})],1)}}],null,!1,3448665797)})],1),r("div",{staticClass:"optimise-wrapper"},[r("optimise-basket")],1)],1)],1)],1)},n=[],s=(r("7db0"),r("c975"),r("d81d"),r("5530")),o=r("2d20"),c=r("2f62"),a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("h2",[t._v("Scenarios")]),r("div",{staticClass:"table-wrapper"},[r("a-table",{staticClass:"axpi-table",attrs:{"data-source":t.scenarios,pagination:!1,columns:t.columns},scopedSlots:t._u([{key:"expectedCost",fn:function(e){return r("div",{},[t._v(" "+t._s(t.formatCostInPence2dp({cost:e,cost_currency:"USD"}))+" ")])}},{key:"co2e",fn:function(e){return r("div",{},[r("span",e?[t._v(t._s(t.formatCo2e(e))+" kg")]:[t._v("Unknown")])])}},{key:"itemsAllocated",fn:function(e){return r("div",{},[r("div",{staticClass:"bullet-chart"},[r("div",{staticClass:"left"},[r("a-progress",{attrs:{percent:e/t.basket.length*100,"show-info":!1}})],1),r("div",{staticClass:"right"},[t._v(" "+t._s(e)+"/"+t._s(t.basket.length)+" ")])])])}},{key:"actions",fn:function(e,i){return r("div",{},[r("div",{staticClass:"actions"},[r("a-button",{on:{click:function(e){return e.preventDefault(),function(){return t.optimise(i.minimise)}()}}},[t._v("Select")])],1)])}}])})],1)])},u=[],d=(r("4de4"),r("2ef0")),p=[{title:"Scenario",dataIndex:"name"},{title:"Expected Cost",dataIndex:"expectedCost",scopedSlots:{customRender:"expectedCost"}},{title:"CO2e",dataIndex:"co2e",scopedSlots:{customRender:"co2e"}},{dataIndex:"itemsAllocated",title:"Items Allocated",key:"itemsAllocated",scopedSlots:{customRender:"itemsAllocated"}},{title:"",scopedSlots:{customRender:"actions"}}],l={name:"OptimiseWrapper",mixins:[o["a"]],data:function(){return{columns:p}},methods:Object(s["a"])(Object(s["a"])({},Object(c["b"])("shop",{setBasket:"setBasket"})),{},{formatCo2e:function(t){return Math.round(100*t)/100},optimise:function(t){"cost"===t&&this.setBasket(d.map(this.basket,(function(t){return Object(s["a"])(Object(s["a"])({},t),{},{selectedPrice:d.first(d.orderBy(t.prices,"price"))})}))),"co2e"===t&&this.setBasket(d.map(this.basket,(function(t){return Object(s["a"])(Object(s["a"])({},t),{},{selectedPrice:d.first(d.orderBy(t.prices,"co2e"))})})))}}),computed:Object(s["a"])(Object(s["a"])({},Object(c["c"])("shop",{basket:"basket"})),{},{itemData:function(){return d.map(this.basket,(function(t){return"product"==t.itemType?d.map(t.prices,(function(e){return{price:e.price*t.quantity,co2e:e.co2e*t.quantity}})):t.prices}))},minPricesScenario:function(){return d.map(this.itemData,(function(t){var e=d.orderBy(t,"price");return d.first(e)}))},minPricesScenarioPrices:function(){var t=d.map(this.minPricesScenario,"price");return d.filter(t,(function(t){return t}))},minPricesScenarioCo2es:function(){var t=d.map(this.minPricesScenario,"co2e");return d.filter(t,(function(t){return t}))},minCo2esScenario:function(){return d.map(this.itemData,(function(t){var e=d.orderBy(t,"co2e");return d.first(e)}))},minCo2esScenarioPrices:function(){var t=d.map(this.minCo2esScenario,"price");return d.filter(t,(function(t){return t}))},minCo2esScenarioCo2es:function(){var t=d.map(this.minCo2esScenario,"co2e");return d.filter(t,(function(t){return t}))},scenarios:function(){return[{name:"Best Price",minimise:"cost",expectedCost:d.sum(this.minPricesScenarioPrices),co2e:d.sum(this.minPricesScenarioCo2es),itemsAllocated:this.minPricesScenarioPrices.length},{name:"Environmentally Friendly",minimise:"co2e",expectedCost:d.sum(this.minCo2esScenarioPrices),co2e:d.sum(this.minCo2esScenarioCo2es),itemsAllocated:this.minCo2esScenarioCo2es.length}]}})},m=l,f=(r("60ed0"),r("2877")),g=Object(f["a"])(m,a,u,!1,null,"1bc6efad",null),h=g.exports,y=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("a-dropdown-button",{attrs:{disabled:t.requested||t.isSaving,trigger:["click"]},on:{click:function(e){return e.preventDefault(),t.requestQuote(e)}}},[t._v(" "+t._s(t.buttonText)+" "),r("a-icon",{attrs:{slot:"icon",type:"down"},slot:"icon"}),r("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[r("a-menu-item",{key:"1"},[r("a-icon",{attrs:{type:"clock-circle"}}),t._v(" Create order window ")],1)],1)],1)},v=[],S={name:"RequestQuoteButton",data:function(){return{isSaving:!1,requested:!1}},computed:{buttonText:function(){return this.isSaving?"Requesting Quote...":this.requested?"Quote Requested":"Request Quote"}},methods:{requestQuote:function(){var t=this;t.isSaving=!0,window.setTimeout((function(){t.isSaving=!1,t.requested=!0}),1e3)}}},_=S,P=Object(f["a"])(_,y,v,!1,null,"12ca9830",null),w=P.exports,k=r("655a"),b=r("bc3a"),C=r.n(b),x=r("81f6"),I=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("a-table",{staticClass:"basketRowInnerTable",attrs:{columns:t.columns,"data-source":t.innerRows,pagination:!1,"show-header":!1,expandIconAsCell:!1,"expand-icon":t.getExpandIcon,"expand-icon-column-index":4},scopedSlots:t._u([{key:"icon",fn:function(t){return r("div",{},[r("a-icon",{staticClass:"rowIcon",attrs:{type:t,theme:"twoTone"}})],1)}},{key:"name",fn:function(e){return r("div",{},[r("span",{staticClass:"name"},[t._v(t._s(e))])])}},{key:"summary",fn:function(e,i){return r("div",{},[r("div",{staticClass:"summary-column"},["Suggested Prices"==i.title?r("div",[r("span",{staticStyle:{"margin-right":"5px"}},[t._v(" "+t._s(t.suggestedPriceRange)+" ")])]):t._e(),"Similar Products"==i.title?r("div",["order"==t.row.itemType?r("span",[t._v(" "+t._s(t.suggestedPriceRangeForOrder)+" ")]):t._e(),"product"==t.row.itemType?r("span",[t._v(" "+t._s(t.suggestedPriceRangeForSimilarProducts)+" ")]):t._e()]):t._e(),"Savings Summary"==i.title?r("div",[r("span",{staticStyle:{"margin-right":"5px"}},[t._v(" "+t._s(t.savingsRange)+" ")])]):t._e()])])}},{key:"summary-tags",fn:function(e,i){return r("div",{},["Suggested Prices"==i.title?r("div",["product"!==t.row.itemType?r("a-tag",{staticStyle:{"margin-right":"0"},attrs:{color:"blue"}},[t._v("Suggested")]):t._e()],1):t._e(),"Similar Products"==i.title?r("div",["product"!==t.row.itemType?r("a-progress",{attrs:{type:"circle",width:30,percent:100}}):t._e()],1):t._e()])}},{key:"additional_summary",fn:function(e,i){return r("div",{},["Suggested Prices"==i.title?r("div",[r("span",{staticStyle:{"margin-right":"5px"}},[t._v(" "+t._s(t.suggestedPriceCo2eRange)+" ")])]):t._e(),"Similar Products"==i.title?r("div",[t.similarProductCo2e?t._e():r("a-tag",{attrs:{color:"red"}},[t._v("Unknown")]),t.similarProductCo2e?r("span",[t._v(t._s(t.similarProductCo2e))]):t._e()],1):t._e(),"Savings Summary"==i.title?r("div",[r("a-tag",{attrs:{color:"red"}},[t._v("Unknown")])],1):t._e()])}},{key:"expandedRowRender",fn:function(e){return r("div",{staticClass:"basket-row-inner-expanded-row-render"},["Suggested Prices"==e.title?r("suggested-prices",{attrs:{row:t.row}}):t._e(),"Similar Products"==e.title?r("similar-products",{attrs:{row:t.row}}):t._e(),"Savings Summary"==e.title?r("savings-summary",{attrs:{row:t.row}}):t._e()],1)}}])})],1)},R=[],O=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("a-table",{staticClass:"suggested-prices-row",attrs:{slot:"expandedRowRender",columns:t.columns,"data-source":t.pricesWithSavings,pagination:!1},slot:"expandedRowRender",scopedSlots:t._u([{key:"supplier",fn:function(e,i){return r("div",{},[r("span",{staticStyle:{"margin-right":"15px"}},[t._v(t._s(e))]),t._l(t.limitCertifications(i.supplier_certifications,i.id),(function(e,i){return r("a-tag",{key:t.getCertificationKey(i),attrs:{color:"blue"}},[t._v(" "+t._s(e.name)+" ")])})),t.howManyMoreCertifications(i.supplier_certifications,i.id)>0?r("a",{attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),function(){return t.toggleShowMoreCertificationsForPrice(i)}()}}},[t._v(" + "+t._s(t.howManyMoreCertifications(i.supplier_certifications,i.id))+" more ")]):t._e(),t.showMoreCertificationsForPriceIds.includes(i.id)?r("a",{attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),function(){return t.toggleShowMoreCertificationsForPrice(i)}()}}},[t._v(" Show less ")]):t._e()],2)}},{key:"cost",fn:function(e,i){return r("div",{},[t._v(" "+t._s(i.price?t.formatCostInPence2dp({cost:i.price,cost_currency:"USD"}):"-")+" ")])}},{key:"savings",fn:function(e){return r("div",{},[t._v(" "+t._s(e?t.formatCostInPence2dp({cost:e,cost_currency:"USD"}):"-")+" ")])}},{key:"co2e",fn:function(e){return r("div",{},[t.getSupplierCo2e(e,t.row)?r("span",[t._v(" "+t._s(t.getSupplierCo2e(e,t.row))+" kg ")]):r("a-tag",{attrs:{color:"red"}},[t._v("Unknown")])],1)}}])})},T=[],q=(r("caad"),r("fb6a"),r("2532"),r("2ef0")),D=[{title:"Supplier",dataIndex:"supplier_name",key:"supplier_name",scopedSlots:{customRender:"supplier"}},{title:"Cost",dataIndex:"cost",key:"cost",scopedSlots:{customRender:"cost"}},{title:"Savings",dataIndex:"savings",key:"savings",scopedSlots:{customRender:"savings"}},{title:"CO2e",dataIndex:"co2e",key:"co2e",scopedSlots:{customRender:"co2e"}}],Q={name:"SuggestedPrices",mixins:[o["a"]],props:["row"],data:function(){return{columns:D,showMoreCertificationsForPriceIds:[]}},computed:{benchmarkPrice:function(){var t=q.map(this.row.prices,"price"),e=1.3*q.mean(t);return this.row.order&&3==this.row.order.id?1618359:e},pricesWithSavings:function(){var t=this;return q.map(this.row.prices,(function(e){return Object(s["a"])({savings:t.benchmarkPrice-e.price},e)}))}},methods:{getSupplierCo2e:function(t,e){var r=t;return"product"===e.itemType&&(r*=e.quantity),r?Math.round(100*r)/100:0},limitCertifications:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.showMoreCertificationsForPriceIds.includes(e)?t:t.slice(0,2)},howManyMoreCertifications:function(t,e){return this.showMoreCertificationsForPriceIds.includes(e)?0:t.length-2},getCertificationKey:function(t){return"certification-"+Math.random()+"-"+t},toggleShowMoreCertificationsForPrice:function(t){this.showMoreCertificationsForPriceIds=q.xor(this.showMoreCertificationsForPriceIds,[t.id])}}},M=Q,U=(r("9d45"),Object(f["a"])(M,O,T,!1,null,null,null)),B=U.exports,j=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("a-table",{staticClass:"similar-products-row",attrs:{slot:"expandedRowRender",columns:t.columns,loading:t.row.isLoadingSuggestedProducts,"data-source":t.similarProducts,pagination:!1},slot:"expandedRowRender",scopedSlots:t._u([{key:"productName",fn:function(e){return r("div",{},[t._v(" "+t._s(e)+" "),"order"==t.row.itemType?r("a-tag",{staticStyle:{"margin-left":"5px"},attrs:{color:"blue"}},[t._v("Past Order")]):t._e()],1)}},{key:"orderDate",fn:function(e){return r("div",{},[t._v(" "+t._s(e?t.formatDate(e):"-")+" ")])}},{key:"cost",fn:function(e,i){return r("div",{},[t._v(" "+t._s(t.formatCostInPence2dp(i))+" ")])}},{key:"similarity",fn:function(t){return r("div",{},[r("a-progress",{staticStyle:{float:"right"},attrs:{type:"circle",width:38,percent:t}})],1)}}])},[r("div",{attrs:{slot:"compare"},slot:"compare"},[r("a-button",{staticStyle:{float:"right"},attrs:{icon:"eye"}},[t._v("Compare")])],1)])},E=[],L=(r("b0c0"),r("6e12")),F={formatSupplierName:function(t){return"Courtney Colour"===t||"Razer Graphix"===t?"ASL Supplier 1":"Eco Design - Eco Print"===t?"ASL Supplier 3":"FG Print"===t?"ASL Supplier 4":t}},A=r("2ef0"),$={name:"SimilarProducts",props:["row"],mixins:[L["a"],o["a"]],data:function(){return{}},computed:{columns:function(){var t=[{title:"Name",dataIndex:"product_name",scopedSlots:{customRender:"productName"}},{title:"Quantity",dataIndex:"quantity"},{title:"Supplier",dataIndex:"supplier.name"}];return"order"==this.row.itemType&&t.push({title:"Order Date",dataIndex:"order_date",scopedSlots:{customRender:"orderDate"}}),t.push({title:"Cost",dataIndex:"cost",scopedSlots:{customRender:"cost"}}),t.push({title:"",dataIndex:"similarity",scopedSlots:{customRender:"similarity"}}),t.push({title:"",scopedSlots:{customRender:"compare"}}),t},similarProducts:function(){var t=this;if("order"==this.row.itemType)return[Object(s["a"])(Object(s["a"])({},this.row.order),{},{supplier:{name:F.formatSupplierName(this.row.order.supplier.name)},similarity:100}),{product_name:"Smirnoff Poster",quantity:1215983,supplier:{name:"ASL Supplier 2"},order_date:"2020-01-13",similarity:87,cost:1562200,cost_currency:"USD"}];if("product"==this.row.itemType){if(!this.row.suggestedProducts)return[];var e=A.orderBy(this.row.suggestedProducts,"cost");return A.map(e,(function(e,r){var i={product_name:e.name,quantity:t.row.quantity,supplier:{name:F.formatSupplierName(e.supplier_name)},similarity:0===r?93:Math.round(70+15*Math.random()),cost:e.cost*t.row.quantity,cost_currency:e.cost_currency};return e.order_date&&(i.order_date=e.order_date),i}))}return[]}}},z=$,N=(r("31a2"),Object(f["a"])(z,j,E,!1,null,null,null)),W=N.exports,K=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("a-table",{staticClass:"similar-products-row",attrs:{slot:"expandedRowRender",columns:t.columns,"data-source":t.comparisons,pagination:!1},slot:"expandedRowRender",scopedSlots:t._u([{key:"comparison",fn:function(e,i){return r("div",{},[t._v(" "+t._s(e)+" "),i.similarity?r("a-progress",{staticStyle:{"margin-left":"10px"},attrs:{type:"circle",width:37,percent:i.similarity}}):t._e()],1)}},{key:"cost",fn:function(e,i){return r("div",{},[t._v(" "+t._s(i.cost?t.formatCostInPence2dp({cost:i.cost,cost_currency:"USD"}):"-")+" ")])}},{key:"savings",fn:function(e,i){return r("div",{},[r("span",[t._v(t._s(i.cost?t.formatCostInPence2dp({cost:i.savings,cost_currency:"USD"}):"-"))]),"product"!==t.row.itemType&&"Similar Match"!==i.comparison?r("a-tag",{staticStyle:{"margin-left":"15px"},attrs:{color:i.savings&&i.savings>0?"green":"red"}},[t._v("P&L ")]):t._e(),"product"!==t.row.itemType&&"Similar Match"==i.comparison?r("a-tag",{staticStyle:{"margin-left":"15px"},attrs:{color:i.savings&&i.savings>0?"green":"red"}},[t._v("Cost Avoidance ")]):t._e(),"product"==t.row.itemType?r("a-tag",{staticStyle:{"margin-left":"15px"},attrs:{color:i.savings&&i.savings>0?"green":"red"}},[t._v(" Cost Avoidance ")]):t._e()],1)}}])})},H=[],G=r("2ef0"),J=[{title:"Comparison",dataIndex:"comparison",scopedSlots:{customRender:"comparison"}},{title:"Cost",dataIndex:"cost",key:"cost",scopedSlots:{customRender:"cost"}},{title:"Savings",dataIndex:"savings",key:"savings",scopedSlots:{customRender:"savings"}}],V={name:"SavingsSummary",props:["row"],mixins:[L["a"],o["a"]],data:function(){return{columns:J}},computed:{benchmarkPrice:function(){if("product"==this.row.itemType&&this.row.suggestedProducts.length){var t=G.map(this.row.suggestedProducts,"cost");return G.min(t)*this.row.quantity}if(this.row.order&&3==this.row.order.id)return 1618359;var e=G.map(this.row.prices,"price"),r=1.3*G.mean(e);return r},comparisons:function(){var t=[];return"product"==this.row.itemType&&t.push({comparison:this.row.suggestedProducts.length?"Similar Match":"Benchmark",similarity:93,cost:this.benchmarkPrice,savings:this.row.selectedPrice?this.benchmarkPrice-this.row.selectedPrice.price*this.row.quantity:0}),"product"!==this.row.itemType&&t.push({comparison:"Historic TruePrice",cost:this.benchmarkPrice,savings:this.row.selectedPrice?this.benchmarkPrice-this.row.selectedPrice.price:0}),this.row.order&&(t.push({comparison:"Exact Match",cost:this.row.order.cost,savings:this.row.selectedPrice?this.row.order.cost-this.row.selectedPrice.price:0}),t.push({comparison:"Similar Match",cost:1562200,savings:this.row.selectedPrice?1562200-this.row.selectedPrice.price:0,similarity:87})),t}}},X=V,Y=(r("37db"),Object(f["a"])(X,K,H,!1,null,null,null)),Z=Y.exports,tt=r("2ef0"),et={name:"BasketRowInner",components:{SavingsSummary:Z,SimilarProducts:W,SuggestedPrices:B},mixins:[o["a"]],props:["row"],data:function(){return{columns:[{dataIndex:"icon",scopedSlots:{customRender:"icon"},width:50},{dataIndex:"title",scopedSlots:{customRender:"name"}},{dataIndex:"summary",scopedSlots:{customRender:"summary"}},{dataIndex:"summary",scopedSlots:{customRender:"summary-tags"}},{dataIndex:"additional_summary",scopedSlots:{customRender:"additional_summary"}},{}]}},methods:{getExpandIcon:function(t){var e=t.expanded,r=t.record,i=t.onExpand,n=this.$createElement;return"Lifespan"!==r.section?n("a-button",{style:"font-weight: 500; padding-left: 0; padding-right; 0; float: right;",attrs:{type:"link"},on:Object(s["a"])({},{click:i.bind(this,[e,r])})},[n("span",[e?"Hide":"Expand"]),n("a-icon",{style:"font-size: 10px; font-weight: 500;",attrs:{type:e?"up":"down"}})]):n("a-button",{style:"opacity: 0; cursor: default;"})}},computed:{innerRows:function(){var t=[{icon:"thunderbolt",title:"Suggested Prices"}];return"order"!==this.row.itemType&&"product"!==this.row.itemType||t.push({icon:"gold",title:"Similar Products"}),t.push({icon:"dollar",title:"Savings Summary"}),t},similarProductCo2e:function(){var t=tt.map(this.row.suggestedProducts,"co2e");if(t=tt.filter(t,(function(t){return t})),console.log("co2es"),console.log(t),t.length){var e=tt.sum(t);return e?Math.floor(tt.sum(t)*this.row.quantity*100)/100+" kg":null}return null},benchmarkPrice:function(){if("product"==this.row.itemType&&this.row.suggestedProducts.length){var t=tt.map(this.row.suggestedProducts,"cost");return tt.min(t)*this.row.quantity}if(this.row.order&&3==this.row.order.id)return 1618359;var e=tt.map(this.row.prices,"price"),r=1.3*tt.mean(e);return r},comparisons:function(){var t=[{comparison:"Benchmark",cost:this.benchmarkPrice,savings:this.row.selectedPrice?this.benchmarkPrice-this.row.selectedPrice.price:0}];return this.row.order&&(t.push({comparison:"Exact Match",cost:this.row.order.cost,savings:this.row.selectedPrice?this.row.order.cost-this.row.selectedPrice.price:0}),t.push({comparison:"Similar Match",cost:1562200,savings:this.row.selectedPrice?1562200-this.row.selectedPrice.price:0,similarity:87})),t},savingsRange:function(){var t=tt.orderBy(this.comparisons,"savings"),e=tt.first(t),r=tt.last(t);if(e!==r){var i=this.formatCostInPence2dp({cost:e.savings,cost_currency:"USD"}),n=this.formatCostInPence2dp({cost:r.savings,cost_currency:"USD"});return i+" → "+n}return this.formatCostInPence2dp({cost:e.savings,cost_currency:"USD"})},suggestedPriceRangeForOrder:function(){if(this.row.order){var t=[this.row.order.cost];3==this.row.order.id&&t.push(1562200);var e=tt.min(t),r=tt.max(t);if(e!==r){var i=this.formatCostInPence2dp({cost:e,cost_currency:"USD"}),n=this.formatCostInPence2dp({cost:r,cost_currency:"USD"});return i+" → "+n}return this.formatCostInPence2dp({cost:e,cost_currency:"USD"})}return""},suggestedPriceRangeForSimilarProducts:function(){if(!this.row.suggestedProducts||0===this.row.suggestedProducts.length)return"";var t=tt.orderBy(this.row.suggestedProducts,"cost"),e=tt.first(t),r=tt.last(t);if(e!==r){var i=this.formatCostInPence2dp({cost:e.cost*this.row.quantity,cost_currency:"USD"}),n=this.formatCostInPence2dp({cost:r.cost*this.row.quantity,cost_currency:"USD"});return i+" → "+n}return this.formatCostInPence2dp({cost:e.cost*this.row.quantity,cost_currency:"USD"})},suggestedPriceRange:function(){var t=this.row.prices;if(t&&t.length){var e=tt.orderBy(t,"price"),r=tt.first(e),i=tt.last(e);if(r!==i){var n=this.formatCostInPence2dp({cost:r.price,cost_currency:"USD"}),s=this.formatCostInPence2dp({cost:i.price,cost_currency:"USD"});return n+" → "+s}return this.formatCostInPence2dp({cost:r.price,cost_currency:"USD"})}return"-"},suggestedPriceCo2eRange:function(){var t=this.row.prices;if(t&&t.length){var e=tt.orderBy(t,"co2e"),r=tt.first(e).co2e,i=tt.last(e).co2e;if(r!==i){var n=Math.floor(100*r)/100,s=Math.floor(100*i)/100;return n+" → "+s+" kg"}return Math.floor(100*r)/100+" kg"}return"-"}}},rt=et,it=(r("e4aa"),Object(f["a"])(rt,I,R,!1,null,null,null)),nt=it.exports,st=r("2ef0"),ot=[{title:"Supplier",dataIndex:"supplier_name",key:"supplier_name"},{title:"Cost",dataIndex:"cost",key:"cost",scopedSlots:{customRender:"cost"}},{title:"CO2e",dataIndex:"co2e",key:"co2e",scopedSlots:{customRender:"co2e"}}],ct={name:"Basket",mixins:[o["a"]],components:{BasketRowInner:nt,RequestQuoteButton:w,OptimiseBasket:h,EditOrderModal:k["a"]},data:function(){return{innerColumns:ot,columns:[{title:"",width:20,scopedSlots:{customRender:"image"}},{title:"Name",dataIndex:"name",width:200,scopedSlots:{customRender:"name"}},{title:"Quantity",dataIndex:"quantity",scopedSlots:{customRender:"quantity"},width:140},{title:"Supplier",dataIndex:"supplier",scopedSlots:{customRender:"supplier"},width:130},{title:"Cost",dataIndex:"cost",scopedSlots:{customRender:"cost"},width:110},{title:"",dataIndex:"cost",scopedSlots:{customRender:"cost-tags"},width:180},{title:"CO2e",dataIndex:"co2e",scopedSlots:{customRender:"co2e"},width:100},{title:"",scopedSlots:{customRender:"actions"},width:10}],suppliers:[],isLoadingSuppliers:!1}},created:function(){this.loadSuppliers();var t=this;x["a"].$on("specification-updated",(function(e){var r=st.find(t.basket,(function(t){return"specification"===t.itemType&&t.id===e.id}));t.loadTruepricesForSpecification({spec:{id:e.id},quantity:r.quantity})})),x["a"].$on("order-updated",(function(e){var r=st.find(t.basket,(function(t){return"order"===t.itemType&&t.id===e.id}));t.loadTruepricesForOrder({order:{id:e.id},quantity:r.quantity})}))},methods:Object(s["a"])(Object(s["a"])(Object(s["a"])({},Object(c["b"])("shop",{incrementProductQuantity:"incrementProductQuantity",decrementProductQuantity:"decrementProductQuantity",setProductQuantity:"setProductQuantity",incrementPastOrderQuantity:"incrementPastOrderQuantity",decrementPastOrderQuantity:"decrementPastOrderQuantity",setPastOrderQuantity:"setPastOrderQuantity",incrementSpecificationQuantity:"incrementSpecificationQuantity",decrementSpecificationQuantity:"decrementSpecificationQuantity",setSpecificationQuantity:"setSpecificationQuantity",updateBasketSelectedPrice:"updateBasketSelectedPrice",loadTruepricesForSpecification:"loadTruepricesForSpecification",loadTruepricesForOrder:"loadTruepricesForOrder"})),Object(c["b"])("orderEditor",{setWizardStage:"setWizardStage",loadOrder:"loadOrder",loadSpecification:"loadSpecification"})),{},{getSavingType:function(t){var e=st.map(t.prices,"price"),r=1.3*st.mean(e);if(t.order&&t.order.cost){var i=t.order.supplier_id==t.selectedPrice.supplier_id;if(t.order.cost<r&&i)return"Exact"}return"Suggested"},getSavings:function(t){var e=st.map(t.prices,"price"),r=1.3*st.mean(e),i=r-t.selectedPrice.price;if(t.order&&t.order.cost){var n=t.order.cost-t.selectedPrice.price;if(t.order.cost<r)return n}if(t.suggestedProducts&&t.suggestedProducts.length){var s=st.orderBy(t.suggestedProducts,"cost"),o=st.first(s).cost,c=o-t.selectedPrice.price;if(o<r)return c*t.quantity}return i},loadSuppliers:function(){var t=this;t.isLoadingSuppliers=!0,C.a.get(window.API_BASE+"/suppliers").then((function(e){t.suppliers=e.data,t.isLoadingSuppliers=!1})).catch((function(e){console.log(e),t.isLoadingSuppliers=!1,t.$message.error("Error loading suppliers")}))},editOrder:function(t){this.setWizardStage(0),this.loadOrder(t.id)},editSpecification:function(t){this.setWizardStage(0),this.loadSpecification(t.id)},getPriceToShow:function(t,e,r){return"product"===r?t*e:t},getTotalCo2e:function(t){var e=0;return"product"===t.itemType&&t.selectedPrice&&t.selectedPrice.co2e?e=Math.round(t.quantity*t.selectedPrice.co2e*100)/100:t.selectedPrice&&t.selectedPrice.co2e&&(e=Math.round(100*t.selectedPrice.co2e)/100),e||0},getSupplierCo2e:function(t,e){var r=t;return"product"===e.itemType&&(r*=e.quantity),r?Math.round(100*r)/100:0},filterOption:function(t,e){return e.componentOptions.children[0].text.toLowerCase().indexOf(t.toLowerCase())>=0},getProductPageUrl:function(t){return"/products/"+t["id"]+"?fromBasket=1"},getOrderUrl:function(t){return"/orders/"+t.id},goBackToShop:function(){this.$router.push("/shop")},getImageSrc:function(t){return t["product"]&&t["product"]["imageURLs"]&&t["product"]["imageURLs"].length?t["product"]["imageURLs"][0]:"/img/icons/basket-order-icon.png"},selectPrice:function(t,e){this.updateBasketSelectedPrice({selectedPrice:e,basketItem:t})},selectPriceById:function(t,e){this.updateBasketSelectedPrice({selectedPrice:st.find(t.prices,{id:e}),basketItem:t})},getExpandIcon:function(t){var e=t.expanded,r=t.record,i=t.onExpand,n=this.$createElement;return n("a-button",{style:"font-weight: 500; padding-left: 0; padding-right; 0; float: right;",attrs:{type:"link"},on:Object(s["a"])({},{click:i.bind(this,[e,r])})},[n("span",[e?"Hide":"Expand"]),n("a-icon",{style:"font-size: 10px; font-weight: 500;",attrs:{type:e?"up":"down"}})])}}),computed:Object(s["a"])(Object(s["a"])({},Object(c["c"])("shop",{basket:"basket",isLoading:"isLoading",tableUpdateKey:"tableUpdateKey"})),Object(c["c"])("orderEditor",{order:"order",type:"type"}))},at=ct,ut=(r("af03"),Object(f["a"])(at,i,n,!1,null,"23f4c497",null));e["default"]=ut.exports},"31a2":function(t,e,r){"use strict";r("1045")},"37db":function(t,e,r){"use strict";r("f16a")},"60ed0":function(t,e,r){"use strict";r("2d8f")},"611a":function(t,e,r){},"8ade":function(t,e,r){},"9d45":function(t,e,r){"use strict";r("8ade")},af03:function(t,e,r){"use strict";r("2635")},e4aa:function(t,e,r){"use strict";r("611a")},f16a:function(t,e,r){}}]);
//# sourceMappingURL=basket.a50d05bd.js.map