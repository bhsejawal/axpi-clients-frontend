(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["projects"],{"1e7a":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"projects"},[a("div",{staticClass:"page-header"},[a("h1",{staticClass:"page-title"},[e._v("Projects")]),a("div",{staticClass:"actions"},[a("create-project-button-and-modal")],1)]),a("projects-table")],1)},r=[],s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-tabs",{model:{value:e.statusToShow,callback:function(t){e.statusToShow=t},expression:"statusToShow"}},[a("a-tab-pane",{key:null,attrs:{tab:"All"}}),a("a-tab-pane",{key:0,attrs:{tab:"Open"}}),a("a-tab-pane",{key:1,attrs:{tab:"Closed"}})],1),a("a-table",{staticClass:"axpi-table",attrs:{columns:e.columns,"row-key":function(e){return e.id},"data-source":e.data,pagination:e.pagination,loading:e.loading},on:{change:e.handleTableChange},scopedSlots:e._u([{key:"name",fn:function(t,n){return a("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.handleRecordSelected(n)}}},[e._v(e._s(t))])}},{key:"status",fn:function(t){return a("div",{},[a("a-badge",{attrs:{count:e.getHumanReadableStatus(t),"number-style":e.getStatusBadgeStyle(t)}})],1)}},{key:"numberOfOrders",fn:function(t){return a("div",{},[e._v(" "+e._s(t)+" ")])}},{key:"spend",fn:function(t){return a("div",{},[e._v(" Â£1,000,000 "+e._s(t)+" ")])}}])})],1)},o=[],i=a("5530"),c=a("6e12"),l=a("bc3a"),u=a.n(l),d=a("2ef0"),f=[{title:"Name",dataIndex:"name",sorter:!0,scopedSlots:{customRender:"name"}},{title:"Status",dataIndex:"status",sorter:!0,scopedSlots:{customRender:"status"}},{title:"Orders",dataIndex:"numberOfOrders",sorter:!0,scopedSlots:{customRender:"numberOfOrders"}},{title:"Spend",dataIndex:"spend",sorter:!0,scopedSlots:{customRender:"spend"}}],h={name:"ProjectsTable",props:["reloadKey"],data:function(){return{statusToShow:null,data:[],pagination:{},loading:!1,filters:{filters_enabled:[]},columns:f}},mixins:[c["a"]],mounted:function(){this.fetch()},watch:{statusToShow:function(){this.fetch()},reloadKey:function(){this.fetch()}},methods:{handleRecordSelected:function(e){this.$router.push("/projects/"+e.id)},handleTableChange:function(e,t,a){var n=Object(i["a"])({},this.pagination);n.current=e.current,this.pagination=n,this.fetch(Object(i["a"])({results_per_page:e.pageSize,page:e.current,sortField:a.field,sortOrder:a.order},t))},determineSearchParams:function(e){var t=this,a={results_per_page:10,status:this.statusToShow};return this.filters&&this.filters.filters_enabled.length&&(a.filters={},d.each(this.filters.filters_enabled,(function(e){a.filters[e]=t.filters[e]}))),Object(i["a"])(Object(i["a"])({},a),e)},fetch:d.debounce((function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.loading=!0,u.a.post(window.API_BASE+"/projects/search",this.determineSearchParams(t)).then((function(t){var a=Object(i["a"])({},e.pagination);a.total=t.data.total,e.loading=!1,e.data=t.data.data,e.pagination=a,e.searchQueryIsDirty=!1})).catch((function(t){console.log(t),e.$message.error("Error loading projects")}))}),500),getHumanReadableStatus:function(e){return 1===e?"Complete":"Ongoing"},getStatusBadgeStyle:function(e){return{backgroundColor:this.getStatusColor(e)}},getStatusColor:function(e){return 1===e?"#46b98e":"#4dc8f2"}}},p=h,m=a("2877"),g=Object(m["a"])(p,s,o,!1,null,"29dc384e",null),v=g.exports,b=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:function(t){return t.preventDefault(),e.showModal(t)}}},[e._v("Create Project")]),a("a-modal",{attrs:{title:"Create Project",visible:e.visible,"confirm-loading":e.isSaving,"ok-text":"Create"},on:{ok:e.attemptSave,cancel:e.handleCancel}},[a("a-form",{attrs:{layout:"vertical",form:e.form}},[a("a-form-item",{attrs:{label:"Name"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"Please enter a name"}]}],expression:"['name', {rules:[{required: true, message: 'Please enter a name'}]}]"}],attrs:{size:"large"}})],1)],1)],1)],1)},S=[],j=(a("b0c0"),a("53ca")),_=a("2ef0"),w={name:"CreateProjectButtonAndModal",data:function(){return{visible:!1,isSaving:!1,form:this.$form.createForm(this,{name:"create_project_form"}),serverErrors:[]}},methods:{showModal:function(){this.visible=!0},attemptSave:function(){var e=this;e.isSaving=!0,this.form.validateFields((function(t,a){t?e.isSaving=!1:e.save(a)}))},save:function(e){var t=this;t.isSaving=!0,t.serverErrors=[],u.a.post(window.API_BASE+"/projects",{name:e.name}).then((function(e){t.$router.push("/projects/"+e.data.id)})).catch((function(e){var a;t.$message.error("Error creating project"),t.isSaving=!1,a="object"===Object(j["a"])(e.response.data)?_.flatten(_.toArray(e.response.data.errors)):["Something went wrong. Please try again."],t.serverErrors=a}))},handleCancel:function(){this.visible=!1}}},y=w,C=(a("f904"),Object(m["a"])(y,b,S,!1,null,"5e5f66e2",null)),O=C.exports,k={name:"Index",components:{CreateProjectButtonAndModal:O,ProjectsTable:v}},P=k,x=Object(m["a"])(P,n,r,!1,null,"53a5d905",null);t["default"]=x.exports},a167:function(e,t,a){},f904:function(e,t,a){"use strict";a("a167")}}]);
//# sourceMappingURL=projects.909dd79b.js.map